
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="OpenSWPC User's Guide">
      
      
        <meta name="author" content="Takuto Maeda">
      
      
        <link rel="canonical" href="https://tktmyd.github.io/OpenSWPC/en/2._Parameters/0206_vmodel/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.6">
    
    
      
        <title>Velocity Model - OpenSWPC</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4a0965b7.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/notosansjp.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:600,800">
    
      <link rel="stylesheet" href="../../../css/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="black">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#velocity-model" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../" title="OpenSWPC" class="md-header__button md-logo" aria-label="OpenSWPC" data-md-component="logo">
      
  <img src="../../../fig/icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenSWPC
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Velocity Model
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="../../../2._Parameters/0206_vmodel/" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="../../../ja/2._Parameters/0206_vmodel/" hreflang="ja" class="md-select__link">
                    Japanese
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/tktmyd/OpenSWPC" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    tktmyd/OpenSWPC
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../" class="md-tabs__link">
      OpenSWPC Users' Guide
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../1._SetUp/0100_trial/" class="md-tabs__link">
        Set up
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../0201_description/" class="md-tabs__link md-tabs__link--active">
        Parameters
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../3._Tools/0301_snapshot/" class="md-tabs__link">
        Tools
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../4._Hints/0401_modelset/" class="md-tabs__link">
        Hints
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Misc/New_Feature/" class="md-tabs__link">
        Misc
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../" title="OpenSWPC" class="md-nav__button md-logo" aria-label="OpenSWPC" data-md-component="logo">
      
  <img src="../../../fig/icon.png" alt="logo">

    </a>
    OpenSWPC
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tktmyd/OpenSWPC" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    tktmyd/OpenSWPC
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        OpenSWPC Users' Guide
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Set up
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Set up" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Set up
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0100_trial/" class="md-nav__link">
        Trial of OpenSWPC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0101_env/" class="md-nav__link">
        System requirements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0102_tree/" class="md-nav__link">
        Code directory tree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0103_compile/" class="md-nav__link">
        Compilation and Execution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0104_dataset/" class="md-nav__link">
        Preparing the Dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1._SetUp/0105_parallel/" class="md-nav__link">
        Execution
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Parameters
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Parameters" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Parameters
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0201_description/" class="md-nav__link">
        Notation of the Parameter File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0202_env/" class="md-nav__link">
        Controlling Parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0203_coord/" class="md-nav__link">
        Coordinates and Parallel Computation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0204_visco/" class="md-nav__link">
        Viscoelastic Bodies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0205_output/" class="md-nav__link">
        Simulation Data Output
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Velocity Model
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Velocity Model
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#choice-of-velocity-model-type" class="md-nav__link">
    Choice of Velocity Model Type
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on-treatments-of-air-and-seawater-layer" class="md-nav__link">
    On Treatments of Air and Seawater Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#small-scale-random-inhomogeneity" class="md-nav__link">
    Small-Scale Random Inhomogeneity
  </a>
  
    <nav class="md-nav" aria-label="Small-Scale Random Inhomogeneity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters-for-uni_rmed" class="md-nav__link">
    Parameters for uni_rmed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameters-for-lhm_rmed" class="md-nav__link">
    Parameters for lhm_rmed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameters-for-grd_rmed" class="md-nav__link">
    Parameters for grd_rmed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#truncation-of-velocity-fluctuations" class="md-nav__link">
    Truncation of Velocity Fluctuations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0207_source/" class="md-nav__link">
        Earthquake Source Specification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0208_abc/" class="md-nav__link">
        Absorbing Boundary Conditions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0209_checkpoint/" class="md-nav__link">
        Checkpointing and Restarting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0210_reciprocity/" class="md-nav__link">
        Reciprocity Mode
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0211_2dcode/" class="md-nav__link">
        About Two-Dimensional Codes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tools" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0301_snapshot/" class="md-nav__link">
        Snapshot data handling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0302_vmodel/" class="md-nav__link">
        Velocity Structure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0303_parameter/" class="md-nav__link">
        Programs for Supporting Parameter Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0304_rmedia/" class="md-nav__link">
        Generation of Random Media
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0305_python/" class="md-nav__link">
        Python integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3._Tools/0306_misc/" class="md-nav__link">
        Miscellaneous Tools
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Hints
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hints" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Hints
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4._Hints/0401_modelset/" class="md-nav__link">
        For Parameter Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4._Hints/0402_modification/" class="md-nav__link">
        For Modifying the Code
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Misc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Misc" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Misc/New_Feature/" class="md-nav__link">
        New features
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Misc/Revision_History/" class="md-nav__link">
        Revision Histories
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Misc/License/" class="md-nav__link">
        License
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="velocity-model">Velocity Model<a class="headerlink" href="#velocity-model" title="Permanent link">&para;</a></h1>
<h2 id="choice-of-velocity-model-type">Choice of Velocity Model Type<a class="headerlink" href="#choice-of-velocity-model-type" title="Permanent link">&para;</a></h2>
<p>Users can choose a uniform (<code>uni</code>), a layered homogeneous medium
(<code>lhm</code>), or a <code>NetCDF</code> (grd) file input (<code>grd</code>) velocity type. In
addition, a randomly inhomogeneous medium calculated by an external
program can be overlaid onto the model.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>vmodel_type</code></strong></dt>
<dd>
<p>Specify the input velocity model. Choose from one of the following.</p>
<dl>
<dt><code>’uni’</code></dt>
<dd>
<p>omogeneous medium with a free surface. The following additional parameters are required:</p>
<ul>
<li><code>vp0</code> : P-wave velocity [km/s] in the uniform model.</li>
<li><code>vs0</code> : S-wave velocity [km/s] in the uniform model.</li>
<li><code>rho0</code> : Mass density [g/cm<span class="arithmatex"><script type="math/tex">{}^3</script></span>] in the uniform model.</li>
<li><code>qp0</code>  :  <span class="arithmatex"><script type="math/tex">Q_P</script></span> of the uniform model.</li>
<li><code>qs0</code>  :  <span class="arithmatex"><script type="math/tex">Q_S</script></span> of the uniform model.</li>
<li><code>topo0</code> : Topography depth in the uniform model. If this value is greater than zero, seawater is filled from <span class="arithmatex"><script type="math/tex">z=0</script></span> to this depth.</li>
</ul>
</dd>
<dt><code>’lhm’</code></dt>
<dd>
<p>Layered Homogeneous Medium. The one-dimensional velocity structure file should be specified as below.</p>
<ul>
<li><code>fn_lhm</code>: Medium specification file. Each line specifies the depth of
the top of the layer, density, P-wave velocity, S-wave
velocity, <span class="arithmatex"><script type="math/tex">Q_P</script></span>, and <span class="arithmatex"><script type="math/tex">Q_S</script></span> below that depth. They must be
separated by space(s) (see following example). Lines
starting with <code>#</code> will be neglected.</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp"># depth  rho(g/cm^3)  vp(km/s)   vs(km/s)     Qp      Qs</span>
<span class="cp"># -------------------------------------------------------</span>
<span class="w">      </span><span class="mi">0</span><span class="w">        </span><span class="mf">2.300</span><span class="w">      </span><span class="mf">5.50</span><span class="w">      </span><span class="mf">3.14</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w"></span>
<span class="w">      </span><span class="mi">3</span><span class="w">        </span><span class="mf">2.400</span><span class="w">      </span><span class="mf">6.00</span><span class="w">      </span><span class="mf">3.55</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w"></span>
<span class="w">     </span><span class="mi">18</span><span class="w">        </span><span class="mf">2.800</span><span class="w">      </span><span class="mf">6.70</span><span class="w">      </span><span class="mf">3.83</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w"></span>
<span class="w">     </span><span class="mi">33</span><span class="w">        </span><span class="mf">3.200</span><span class="w">      </span><span class="mf">7.80</span><span class="w">      </span><span class="mf">4.46</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w"></span>
<span class="w">    </span><span class="mi">100</span><span class="w">        </span><span class="mf">3.300</span><span class="w">      </span><span class="mf">8.00</span><span class="w">      </span><span class="mf">4.57</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w"></span>
<span class="w">    </span><span class="mi">225</span><span class="w">        </span><span class="mf">3.400</span><span class="w">      </span><span class="mf">8.40</span><span class="w">      </span><span class="mf">4.80</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w"></span>
<span class="w">    </span><span class="mi">325</span><span class="w">        </span><span class="mf">3.500</span><span class="w">      </span><span class="mf">8.60</span><span class="w">      </span><span class="mf">4.91</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w"></span>
<span class="w">    </span><span class="mi">425</span><span class="w">        </span><span class="mf">3.700</span><span class="w">      </span><span class="mf">9.30</span><span class="w">      </span><span class="mf">5.31</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
</dd>
<dt><code>’grd’</code></dt>
<dd>
<p>Velocity model input from <code>NetCDF</code> (GMT grd) files. The
compilation of <code>OpenSWPC</code> should be performed in accompaniment
with the use of the <code>NetCDF</code> library. The following parameters
are required.</p>
<ul>
<li>
<p><code>dir_grd</code>: Directory of the velocity structure (<code>NetCDF</code>) files.</p>
</li>
<li>
<p><code>fn_grdslt</code>: List file that specifies the grd files and the associated
medium. Each line contains the grd filename (with a single
or double quotation mark; recommended), density, P-wave
velocity, S-wave velocity, <span class="arithmatex"><script type="math/tex">Q_P</script></span>, <span class="arithmatex"><script type="math/tex">Q_S</script></span>, and the layer
number integers (0-9) separated by spaces (see following
example). Lines starting with <code>#</code> will be neglected. The
layer number is used to specify the source or station depth
fit to the layer depth. The first <code>NetCDF</code> file will be
treated as the ground surface. If the depth of the ground
surface is deeper than zero, the depth range from <span class="arithmatex"><script type="math/tex">z = 0</script></span> to
the surface is assumed to be an ocean layer. The grid above
the free surface is treated as an air column.</p>
</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp"># grd filename          rho    vp    vs    QP   QS  sw</span>
<span class="cp"># -------------------------------------------------------</span>
<span class="err">&#39;</span><span class="n">eJIVSM_01_TAB_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">1.80</span><span class="w">  </span><span class="mf">1.70</span><span class="w">  </span><span class="mf">0.35</span><span class="w">   </span><span class="mi">119</span><span class="w">    </span><span class="mi">70</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_02_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">1.95</span><span class="w">  </span><span class="mf">1.80</span><span class="w">  </span><span class="mf">0.50</span><span class="w">   </span><span class="mi">170</span><span class="w">   </span><span class="mi">100</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_03_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.00</span><span class="w">  </span><span class="mf">2.00</span><span class="w">  </span><span class="mf">0.60</span><span class="w">   </span><span class="mi">204</span><span class="w">   </span><span class="mi">120</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_04_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.05</span><span class="w">  </span><span class="mf">2.10</span><span class="w">  </span><span class="mf">0.70</span><span class="w">   </span><span class="mi">238</span><span class="w">   </span><span class="mi">140</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_05_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.07</span><span class="w">  </span><span class="mf">2.20</span><span class="w">  </span><span class="mf">0.80</span><span class="w">   </span><span class="mi">272</span><span class="w">   </span><span class="mi">160</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_06_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.10</span><span class="w">  </span><span class="mf">2.30</span><span class="w">  </span><span class="mf">0.90</span><span class="w">   </span><span class="mi">306</span><span class="w">   </span><span class="mi">180</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_07_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.15</span><span class="w">  </span><span class="mf">2.40</span><span class="w">  </span><span class="mf">1.00</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_08_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.20</span><span class="w">  </span><span class="mf">2.70</span><span class="w">  </span><span class="mf">1.30</span><span class="w">   </span><span class="mi">442</span><span class="w">   </span><span class="mi">260</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_09_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.25</span><span class="w">  </span><span class="mf">3.00</span><span class="w">  </span><span class="mf">1.50</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_10_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.30</span><span class="w">  </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">1.70</span><span class="w">   </span><span class="mi">578</span><span class="w">   </span><span class="mi">340</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_11_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.35</span><span class="w">  </span><span class="mf">3.50</span><span class="w">  </span><span class="mf">2.00</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_12_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.45</span><span class="w">  </span><span class="mf">4.20</span><span class="w">  </span><span class="mf">2.40</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_13_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.60</span><span class="w">  </span><span class="mf">5.00</span><span class="w">  </span><span class="mf">2.90</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_14_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.65</span><span class="w">  </span><span class="mf">5.50</span><span class="w">  </span><span class="mf">3.20</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_15_UPC_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.70</span><span class="w">  </span><span class="mf">5.80</span><span class="w">  </span><span class="mf">3.40</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_16_LWC_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.80</span><span class="w">  </span><span class="mf">6.40</span><span class="w">  </span><span class="mf">3.80</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_17_CTM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">7.50</span><span class="w">  </span><span class="mf">4.50</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_18_PH2_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.40</span><span class="w">  </span><span class="mf">5.00</span><span class="w">  </span><span class="mf">2.90</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_19_PH3_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.90</span><span class="w">  </span><span class="mf">6.80</span><span class="w">  </span><span class="mf">4.00</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_20_PHM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">8.00</span><span class="w">  </span><span class="mf">4.70</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_21_PA2_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.60</span><span class="w">  </span><span class="mf">5.40</span><span class="w">  </span><span class="mf">2.80</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_22_PA3_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.80</span><span class="w">  </span><span class="mf">6.50</span><span class="w">  </span><span class="mf">3.50</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
<span class="err">&#39;</span><span class="n">eJIVSM_23_PAM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.40</span><span class="w">  </span><span class="mf">8.10</span><span class="w">  </span><span class="mf">4.60</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<ul>
<li>
<p><code>node_grd</code>: MPI node to input the <code>NetCDF</code> data. All <code>NetCDF</code> files are
first read by this node, and then, transferred to all nodes
via MPI data communication.</p>
</li>
<li>
<p><code>is_ocean</code> : In the default (<code>.true.</code>), the depth from <span class="arithmatex"><script type="math/tex">z = 0</script></span> to the set
topography will be treated as an ocean layer. If this
parameter is set to <code>.false.</code>, the seafloor will be used as
a free surface and no seawater will be used.</p>
</li>
<li>
<p><code>topo_flatten</code> : Make topography variatinon flat by offsetting the medium below. </p>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Renaming <code>is_flatten</code> to <code>topo_flatten</code></p>
<p>This option used to be <code>is_flatten</code> until Version 5.1, but has been renamed to avoid confusion with the <code>earth_flattening</code> option implemented in Version 5.2.</p>
</div>
</dd>
<dt><code>’user’</code></dt>
<dd>A user subroutine defined in <code>src/swpc_*/m_vmodel_user.F90</code>
is used for defining velocity model. Recompilation of the code
is necessary if this Fortran file is modified. Please refer the
comments in the file for input/output of the user subroutine.</dd>
</dl>
</dd>
<dt><strong><code>vcut</code></strong></dt>
<dd>Cut-off velocity. For the <code>’lhm’</code> or <code>’grd’</code> models, a velocity
slower than this value will be overwritten by the <code>vcut</code> value. This
parameter is used to avoid wavelengths that are too short and
violate the wavelength condition (the wavelength is recommended to
be longer than 5-10 grids). This substitution will not be performed
in the oceanic area.</dd>
<dt><strong><code>munk_profile</code></strong> &nbsp; <strong>(new in version 5.2)</strong></dt>
<dd>If this value is <code>.true.</code>, the Munk's profile with minima is applied in the seawater layer. Otherwise a constant value of 1.5 km/s is used. See the explanation in the next section.</dd>
<dt><a name="eft"></dt>
<dt><strong> <code>earth_flattening</code></strong> &nbsp;  <strong>(new in version 5.2)</strong></dt>
<dd>If this option is <code>.true.</code>, OpenSWPC performs the transformation the Cartesian coordinate to pseudo-spherical coordinate by means of the Earth-flattening tranformation (e.g., Aki and Richards, Box 9.2). This option may be useful for reproducing accurate arrival time of seismic waves for long (~500 km or more) traveling distances and/or for deep-focus earthquake. Please be noted that this transformation is <strong>not</strong> exact in P-SV and 3D models. </dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The implementation of <code>earth_flattening</code> mode in version 5.2 is still in the experimental stage. Please use it with caution. </p>
</div>
</div>
<h2 id="on-treatments-of-air-and-seawater-layer">On Treatments of Air and Seawater Layer<a class="headerlink" href="#on-treatments-of-air-and-seawater-layer" title="Permanent link">&para;</a></h2>
<p>In <code>OpenSWPC</code>, the air column has a mass density of <span class="arithmatex"><script type="math/tex">\rho=0.001</script></span> [g/cm<span class="arithmatex"><script type="math/tex">{}^3</script></span>], 
velocities of <span class="arithmatex"><script type="math/tex">V_P = V_S = 0</script></span> [km/s], and intrinsic
attenuation parameters of <span class="arithmatex"><script type="math/tex">Q^P = Q^S = 10^{10}</script></span>. 
The air column is treated as a
vacuum with no seismic wave propagation (with zero velocities). However,
<strong>the mass density in the air column must not be zero to avoid division by zero</strong>. </p>
<p>In the ocean column, <span class="arithmatex"><script type="math/tex">\rho= 1.0</script></span> [g/cm<span class="arithmatex"><script type="math/tex">{}^3</script></span>], <span class="arithmatex"><script type="math/tex">V_S = 0.0</script></span> [km/s],
and <span class="arithmatex"><script type="math/tex">Q^P = Q^S = 10^6</script></span> are assumed. 
The attenuation of underwater sound waves is known to be very small, so we have introduced a very large <span class="arithmatex"><script type="math/tex">Q</script></span> values that are virtually unattenuated. 
The P-wave velocity is <span class="arithmatex"><script type="math/tex">V_P=1.5</script></span> km/s, but in the version 5.2 and later, the depth-dependent Munk's profile which is defined the equation below can be used by setting <code>munk_profile = .true.</code>. </p>
<div class="arithmatex">
<script type="math/tex; mode=display">\begin{align*}
&V_P(z) = 1.5 \times \left[ 1.0 + 0.00737 \left( z_b - 1 + e^{-zb} \right) \right] \text{[m/s]}\\
&z_b = 2(z-1.3) /1.3
\end{align*}</script>
</div>
<p>where the unit of <span class="arithmatex"><script type="math/tex">z</script></span> is km. This profile contains a minima which corresponds to the SOFAR channel at a depth of 1300 m. </p>
<p>In the free
surface and seafloor, the reduced order of the finite difference is
performed according to Okamoto and Takenaka (2005<sup id="fnref:OT2005"><a class="footnote-ref" href="#fn:OT2005">1</a></sup>) and Maeda and Furumura (2003<sup id="fnref:MF2003"><a class="footnote-ref" href="#fn:MF2003">2</a></sup>). 
These discontinuities are automatically detected as boundaries that change <span class="arithmatex"><script type="math/tex">\mu</script></span> and <span class="arithmatex"><script type="math/tex">\lambda</script></span> from zero to a finite value.</p>
<h2 id="small-scale-random-inhomogeneity">Small-Scale Random Inhomogeneity<a class="headerlink" href="#small-scale-random-inhomogeneity" title="Permanent link">&para;</a></h2>
<p>Users may overlay small-scale velocity inhomogeneities with specified
power-law spectra on the background velocity models of <code>’uni’</code>, <code>’lhm’</code>,
and <code>’grd’</code>. The small-scale velocity inhomogeneity <span class="arithmatex"><script type="math/tex">\xi</script></span> is defined by
external files. From the average velocities <span class="arithmatex"><script type="math/tex">V_{P0}</script></span>, <span class="arithmatex"><script type="math/tex">V_{S0}</script></span>, and
<span class="arithmatex"><script type="math/tex">\rho_0</script></span>, the fluctuated velocities and density are given as</p>
<div class="arithmatex">
<script type="math/tex; mode=display">\begin{align}
  V_P = V_{P0} \left( 1 + \xi \right) , \, V_S = V_{S0} \left( 1 + \xi \right) , \,
  \rho = \rho_0 \left( 1 + \nu \xi \right)
\end{align}</script>
</div>
<p>where <span class="arithmatex"><script type="math/tex">\nu=0.8</script></span> is a scaling parameter based on a laboratory experiment (Sato et al., 2012<sup id="fnref:SFM2012"><a class="footnote-ref" href="#fn:SFM2012">3</a></sup>).</p>
<p>Velocity models having this small-scale inhomogeneity are specified by
appending <code>_rmed</code> to the original velocity models: <code>vmodel_type=’uni_rmed’</code>, <code>’lhm_rmed’</code>, or <code>’grd_rmed’</code>. </p>
<p>The random media files are generated by a separated program. See <a href="../../3._Tools/0304_rmedia/">this section</a> for details.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>dir_rmed</code></strong></dt>
<dd>A directory name for storing the random media data files.</dd>
</dl>
</div>
<p>The random media are given as two- or three-dimensional <code>NetCDF</code> files.
At each grid location, the velocity fluctuation <span class="arithmatex"><script type="math/tex">\xi(I,J,K)</script></span> is defined.
The code automatically reads the corresponding volume from the file; It
is not necessary to decompose the <code>NetCDF</code> files into parts for parallel
computation. If the computational size (<code>Nx, Ny, Nz</code>) is larger than the
random media file size, the media is used repeatedly by applying a
circular boundary condition. The simulation codes do not care if the
grid sizes of the simulation and the input random media file are
identical.</p>
<p>Note that users may use the 3D random media files for 2D calculation. </p>
<h3 id="parameters-for-uni_rmed">Parameters for <code>uni_rmed</code><a class="headerlink" href="#parameters-for-uni_rmed" title="Permanent link">&para;</a></h3>
<p>The following parameter is required in addition to the parameters used
in <code>vmodel=’uni’</code>.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>fn_rmed0</code></strong></dt>
<dd>Name of the random medium file.</dd>
</dl>
</div>
<p>In this model, the average velocity will be fluctuated based on the
input <code>fn_rmed0</code>.</p>
<h3 id="parameters-for-lhm_rmed">Parameters for <code>lhm_rmed</code><a class="headerlink" href="#parameters-for-lhm_rmed" title="Permanent link">&para;</a></h3>
<p>In this model, the small-scale velocity fluctuation is applied to every
layer defined by <code>vmodel=’lhm’</code>. It is possible to assign different
random velocity models at different layers.</p>
<p>The following parameter is substituted in <code>fn_lhm</code>:</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>fn_lhm_rmed</code></strong></dt>
<dd>List file of the velocity structure.</dd>
</dl>
<p>The list file has a similar format to <code>fn_lhm</code>; it contains the
filenames of the random media files in the rightmost column as in the
following example.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp"># depth  rho(g/cm^3)  vp(km/s)   vs(km/s)     Qp      Qs     fn_rmed</span>
<span class="cp"># ----------------------------------------------------------------------</span>
<span class="w">     </span><span class="mi">0</span><span class="w">        </span><span class="mf">2.300</span><span class="w">      </span><span class="mf">5.50</span><span class="w">      </span><span class="mf">3.14</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="n">rmedia1</span><span class="p">.</span><span class="n">nc</span><span class="w"></span>
<span class="w">     </span><span class="mi">3</span><span class="w">        </span><span class="mf">2.400</span><span class="w">      </span><span class="mf">6.00</span><span class="w">      </span><span class="mf">3.55</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="n">rmedia1</span><span class="p">.</span><span class="n">nc</span><span class="w"></span>
<span class="w">    </span><span class="mi">18</span><span class="w">        </span><span class="mf">2.800</span><span class="w">      </span><span class="mf">6.70</span><span class="w">      </span><span class="mf">3.83</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="n">rmedia2</span><span class="p">.</span><span class="n">nc</span><span class="w"></span>
<span class="w">    </span><span class="mi">33</span><span class="w">        </span><span class="mf">3.200</span><span class="w">      </span><span class="mf">7.80</span><span class="w">      </span><span class="mf">4.46</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="n">rmedia2</span><span class="p">.</span><span class="n">nc</span><span class="w"></span>
<span class="w">    </span><span class="mi">100</span><span class="w">       </span><span class="mf">3.300</span><span class="w">      </span><span class="mf">8.00</span><span class="w">      </span><span class="mf">4.57</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="o">-</span><span class="w"></span>
<span class="w">    </span><span class="mi">225</span><span class="w">       </span><span class="mf">3.400</span><span class="w">      </span><span class="mf">8.40</span><span class="w">      </span><span class="mf">4.80</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="o">-</span><span class="w"></span>
<span class="w">    </span><span class="mi">325</span><span class="w">       </span><span class="mf">3.500</span><span class="w">      </span><span class="mf">8.60</span><span class="w">      </span><span class="mf">4.91</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="o">-</span><span class="w"></span>
<span class="w">    </span><span class="mi">425</span><span class="w">       </span><span class="mf">3.700</span><span class="w">      </span><span class="mf">9.30</span><span class="w">      </span><span class="mf">5.31</span><span class="w">     </span><span class="mi">600</span><span class="w">     </span><span class="mi">300</span><span class="w">     </span><span class="o">-</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
<p>In this example, the layers starting from depths of 0 km and 3 km have
fluctuations defined in <code>rmedia1.nc</code>, and the layers from 18 km and 33
km are defined in <code>rmedia2.nc</code>. For the layer deeper than 100 km, a
dummy filename (<code>-</code>) is given. In this case (i.e., there is no file
found), a fluctuation will not be given. The dummy filename is mandatory
in this case.</p>
</div>
<h3 id="parameters-for-grd_rmed">Parameters for <code>grd_rmed</code><a class="headerlink" href="#parameters-for-grd_rmed" title="Permanent link">&para;</a></h3>
<p>When overlaying the random fluctuations to the layers defined by the
model of <code>vmodel=’grd’</code>, it is possible to assign different random media
to different layers. The starting depth of the velocity fluctuation can
be either the free surface or depths defined by a layer.</p>
<p>The filename of the velocity fluctuation is given by the following
parameter:</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>fn_grdlst_rmed</code></strong></dt>
<dd>A list file that specifies the velocity layer and the random
fluctuation files for each layer.</dd>
</dl>
<p>The list file has two additional columns at the right: the filename of
the random medium and the reference layer number.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cp"># grd filename          rho    vp    vs   QP   QS  sw  fn_rmed      ref</span>
<span class="cp"># -----------------------------------------------------------------------</span>
<span class="err">&#39;</span><span class="n">eJIVSM_01_TAB_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">1.80</span><span class="w">  </span><span class="mf">1.70</span><span class="w">  </span><span class="mf">0.35</span><span class="w">   </span><span class="mi">119</span><span class="w">    </span><span class="mi">70</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_02_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">1.95</span><span class="w">  </span><span class="mf">1.80</span><span class="w">  </span><span class="mf">0.50</span><span class="w">   </span><span class="mi">170</span><span class="w">   </span><span class="mi">100</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_03_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.00</span><span class="w">  </span><span class="mf">2.00</span><span class="w">  </span><span class="mf">0.60</span><span class="w">   </span><span class="mi">204</span><span class="w">   </span><span class="mi">120</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_04_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.05</span><span class="w">  </span><span class="mf">2.10</span><span class="w">  </span><span class="mf">0.70</span><span class="w">   </span><span class="mi">238</span><span class="w">   </span><span class="mi">140</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_05_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.07</span><span class="w">  </span><span class="mf">2.20</span><span class="w">  </span><span class="mf">0.80</span><span class="w">   </span><span class="mi">272</span><span class="w">   </span><span class="mi">160</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_06_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.10</span><span class="w">  </span><span class="mf">2.30</span><span class="w">  </span><span class="mf">0.90</span><span class="w">   </span><span class="mi">306</span><span class="w">   </span><span class="mi">180</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_07_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.15</span><span class="w">  </span><span class="mf">2.40</span><span class="w">  </span><span class="mf">1.00</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_08_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.20</span><span class="w">  </span><span class="mf">2.70</span><span class="w">  </span><span class="mf">1.30</span><span class="w">   </span><span class="mi">442</span><span class="w">   </span><span class="mi">260</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_09_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.25</span><span class="w">  </span><span class="mf">3.00</span><span class="w">  </span><span class="mf">1.50</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_10_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.30</span><span class="w">  </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">1.70</span><span class="w">   </span><span class="mi">578</span><span class="w">   </span><span class="mi">340</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_11_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.35</span><span class="w">  </span><span class="mf">3.50</span><span class="w">  </span><span class="mf">2.00</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_12_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.45</span><span class="w">  </span><span class="mf">4.20</span><span class="w">  </span><span class="mf">2.40</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_13_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.60</span><span class="w">  </span><span class="mf">5.00</span><span class="w">  </span><span class="mf">2.90</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_14_BSM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.65</span><span class="w">  </span><span class="mf">5.50</span><span class="w">  </span><span class="mf">3.20</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_15_UPC_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.70</span><span class="w">  </span><span class="mf">5.80</span><span class="w">  </span><span class="mf">3.40</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_1</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_16_LWC_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.80</span><span class="w">  </span><span class="mf">6.40</span><span class="w">  </span><span class="mf">3.80</span><span class="w">   </span><span class="mi">680</span><span class="w">   </span><span class="mi">400</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_3</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_17_CTM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">7.50</span><span class="w">  </span><span class="mf">4.50</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_3</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_18_PH2_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.40</span><span class="w">  </span><span class="mf">5.00</span><span class="w">  </span><span class="mf">2.90</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_2</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">18</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_19_PH3_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.90</span><span class="w">  </span><span class="mf">6.80</span><span class="w">  </span><span class="mf">4.00</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_2</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">18</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_20_PHM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.20</span><span class="w">  </span><span class="mf">8.00</span><span class="w">  </span><span class="mf">4.70</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_3</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">18</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_21_PA2_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.60</span><span class="w">  </span><span class="mf">5.40</span><span class="w">  </span><span class="mf">2.80</span><span class="w">   </span><span class="mi">340</span><span class="w">   </span><span class="mi">200</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_2</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">21</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_22_PA3_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">2.80</span><span class="w">  </span><span class="mf">6.50</span><span class="w">  </span><span class="mf">3.50</span><span class="w">   </span><span class="mi">510</span><span class="w">   </span><span class="mi">300</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_2</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">21</span><span class="w"></span>
<span class="err">&#39;</span><span class="n">eJIVSM_23_PAM_</span><span class="p">.</span><span class="n">grd</span><span class="err">&#39;</span><span class="w">   </span><span class="mf">3.40</span><span class="w">  </span><span class="mf">8.10</span><span class="w">  </span><span class="mf">4.60</span><span class="w">   </span><span class="mi">850</span><span class="w">   </span><span class="mi">500</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rmed3d_3</span><span class="p">.</span><span class="n">nc</span><span class="err">&#39;</span><span class="w"> </span><span class="mi">21</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
<p>The reference layer number defines the reference depth plane of the
random media. If this number is zero, the depth grid number of the
computational model is directly used to assign the random media. This is
exactly the same as the behavior of the <code>uni_rmed</code> or <code>lhm_rmed</code> models.
If the nonzero value of the reference layer number <code>NR</code> is specified,
the depth of the <code>NR</code> layer is treated as the base plane. The depth grid
of the random medium is measured from this depth. Introducing this
reference plane, the inclined random media according to the velocity
discontinuity (such as the plate boundary) can be specified. In the
above example, the 18th and 21st layers are treated as the references of
18--20th and 21--23th layers, respectively.</p>
</div>
<h3 id="truncation-of-velocity-fluctuations">Truncation of Velocity Fluctuations<a class="headerlink" href="#truncation-of-velocity-fluctuations" title="Permanent link">&para;</a></h3>
<p>If the magnitude of the velocity fluctuation becomes too large, there
can be a spot with non-physical velocity, such as negative velocity or a
velocity too large for the Earth medium. The simulation may be unstable
under the following conditions:</p>
<ol>
<li>
<p>The fluctuated velocity <span class="arithmatex"><script type="math/tex">V=(1+\xi)V_0</script></span> exceeds the stability
    condition for cases with <span class="arithmatex"><script type="math/tex">\xi>0</script></span>.</p>
</li>
<li>
<p>The velocity has unrealistic negative values for cases with
    <span class="arithmatex"><script type="math/tex">\xi<-1.0</script></span>.</p>
</li>
<li>
<p>The mass density has negative values for cases with <span class="arithmatex"><script type="math/tex">\xi<-1.25</script></span>.</p>
</li>
</ol>
<p>To avoid such situations, <code>OpenSWPC</code> automatically limits the range of
the fluctuated velocity to <code>vcut</code><span class="arithmatex"><script type="math/tex">\le v \le 0.95 \times v_\text{max}</script></span>,
where <code>vcut</code> is an input parameter and <span class="arithmatex"><script type="math/tex">v_\text{max}</script></span> is the maximum
possible velocity derived from the stability condition.</p>
<p>In addition, the following parameter controls the minimum density.</p>
<div class="admonition info">
<p class="admonition-title">Parameters</p>
<dl>
<dt><strong><code>rhomin</code></strong></dt>
<dd>Minimum mass density in g/cm<span class="arithmatex"><script type="math/tex">{}^3</script></span>. (1.0 g/cm<span class="arithmatex"><script type="math/tex">{}^3</script></span> by default.)</dd>
</dl>
</div>
<div class="footnote">
<hr />
<ol>
<li id="fn:OT2005">
<p>Okamoto, T., and H. Takenaka (2005). Fluid-solid boundary implementation in the velocity-stress finite- difference method, <em>Zisin 2</em>, <em>57</em>, 355–364, doi:10.4294/zisin1948.57.3_355. (in Japanese with English Abstract) <a href="https://doi.org/10.4294/zisin1948.57.3_355">(article link)</a>&#160;<a class="footnote-backref" href="#fnref:OT2005" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:MF2003">
<p>Maeda, T., and T. Furumura (2013), FDM simulation of seismic waves, ocean acoustic waves, and tsunamis based on tsunami-coupled equations of motion, <em>Pure Appl. Geophys.</em>, <em>170</em>(1-2), 109–127, doi:10.1007/s00024-011-0430-z. <a href="https://doi.org/10.1007/s00024-011-0430-z">(article link)</a>&#160;<a class="footnote-backref" href="#fnref:MF2003" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:SFM2012">
<p>Sato, H., M. C. Fehler, and T. Maeda (2012), <em>Seismic Wave Propagation and Scattering in the Heterogeneous Earth: Second Edition</em>, Springer Berlin Heidelberg, Berlin, Heidelberg, doi:10.1007/978-3-642-23029-5.&#160;<a class="footnote-backref" href="#fnref:SFM2012" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../0205_output/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Simulation Data Output" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Simulation Data Output
            </div>
          </div>
        </a>
      
      
        
        <a href="../0207_source/" class="md-footer__link md-footer__link--next" aria-label="Next: Earthquake Source Specification" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Earthquake Source Specification
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy Takuto Maeda. All Rights Reserved
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/tktmyd" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "toc.integrate", "navigation.sections"], "search": "../../../assets/javascripts/workers/search.85cb4492.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.a877e258.min.js"></script>
      
        <script src="../../../mathjax-config.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>